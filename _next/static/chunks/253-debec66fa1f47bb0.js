"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{5253:function(e,a,t){t.d(a,{default:function(){return v}});var n=t(7437),i=t(2265),r=t(9376),l=t(1525),s=t(2176);function o(e){let{children:a,className:t}=e;return(0,n.jsx)("span",{className:"rounded px-2 py-0.5 text-xs ".concat(t),children:a})}function c(e){let{type:a}=e;return a?(0,n.jsx)(o,{className:"bg-blue-100 text-blue-800",children:a.replace(/_/g," ")}):null}function d(e){let{text:a}=e;return(0,n.jsx)(o,{className:"bg-yellow-100 text-yellow-800",children:a})}function u(e){let{text:a}=e;return(0,n.jsx)(o,{className:"bg-green-100 text-green-800",children:a})}function p(){return(0,n.jsx)(o,{className:"bg-pink-100 text-pink-800",children:"Sponsored"})}function g(e){var a,t,i,r,l;let{item:o,onClick:g}=e,h=[o.profile.city,(0,s.p)(o.profile.country)].filter(Boolean).join(", "),m=o.rewards&&o.rewards.rewardTypes&&o.rewards.rewardTypes.length>0;return(0,n.jsxs)("button",{onClick:g,className:"flex w-full flex-col overflow-hidden rounded border bg-white text-left shadow-sm hover:shadow-md focus:outline-none focus:ring","aria-label":"View details for ".concat(o.title),children:[(0,n.jsx)("div",{className:"h-40 w-full overflow-hidden bg-gray-100",children:o.profile.profileImageUrl?(0,n.jsx)("img",{src:o.profile.profileImageUrl,alt:"".concat(o.profile.organizationName," logo"),className:"h-full w-full object-cover"}):(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center text-gray-400",children:"No image"})}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-2 p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:o.title}),(null===(a=o.boost)||void 0===a?void 0:a.isHighlighted)&&(0,n.jsx)(p,{})]}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,n.jsx)("span",{children:o.profile.organizationName}),o.profile.verified?(0,n.jsx)("span",{className:"ml-1","aria-label":"verified",children:"✔️"}):null]}),(0,n.jsx)("div",{className:"text-xs text-gray-500",children:h}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,n.jsx)(c,{type:o.type}),(0,n.jsx)(d,{text:function(e){if("FREE"===e.fee)return"Free";if(e.applicationFees&&e.applicationFees.length>0){let a=e.applicationFees[0];return"".concat(a.price," ").concat(a.currency)}return e.fee?e.fee:"No fee"}(o)}),m?o.rewards.rewardTypes.map(e=>(0,n.jsx)(u,{text:e},e)):(null===(t=o.rewards)||void 0===t?void 0:t.rewardDescription)&&(0,n.jsx)(u,{text:o.rewards.rewardDescription.slice(0,20)})]}),(0,n.jsx)("div",{className:"text-sm text-gray-700",children:(l=null===(r=o.description)||void 0===r?void 0:null===(i=r[0])||void 0===i?void 0:i.content)?l.replace(/\n+/g," ").slice(0,200)+(l.length>200?"…":""):""}),(0,n.jsxs)("div",{className:"mt-auto text-sm font-medium",children:["Deadline: ",function(e){if(!e)return"No deadline";try{return new Date(e).toLocaleDateString()}catch(a){return e}}(o.deadline)]})]})]})}function h(){return(0,n.jsxs)("div",{className:"flex w-full flex-col overflow-hidden rounded border bg-white p-4 shadow-sm animate-pulse",children:[(0,n.jsx)("div",{className:"mb-4 h-40 w-full bg-gray-200"}),(0,n.jsx)("div",{className:"mb-2 h-4 w-3/4 bg-gray-200"}),(0,n.jsx)("div",{className:"mb-2 h-3 w-1/2 bg-gray-200"}),(0,n.jsx)("div",{className:"h-3 w-full bg-gray-200"})]})}function m(e){let{page:a,totalPages:t,onPageChange:i}=e;if(!t||t<=1)return null;let r=Array.from({length:t},(e,a)=>a+1);return(0,n.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2","aria-label":"Pagination navigation",children:[(0,n.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>i(a-1),disabled:a<=1,"aria-label":"Previous page",children:"Prev"}),r.map(e=>(0,n.jsx)("button",{className:"rounded border px-2 py-1 text-sm ".concat(e===a?"bg-gray-200":""),onClick:()=>i(e),"aria-current":e===a?"page":void 0,children:e},e)),(0,n.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>i(a+1),disabled:a>=t,"aria-label":"Next page",children:"Next"})]})}function f(e){let{value:a,onChange:t}=e;return(0,n.jsxs)("select",{"aria-label":"Sort opportunities",className:"rounded border px-2 py-1 text-sm",value:a,onChange:e=>t(e.target.value),children:[(0,n.jsx)("option",{value:"-deadline",children:"Deadline (latest)"}),(0,n.jsx)("option",{value:"deadline",children:"Deadline (earliest)"}),(0,n.jsx)("option",{value:"-createdAt",children:"Newest"})]})}function x(e){let{value:a,onChange:t}=e;return(0,n.jsxs)("select",{"aria-label":"Items per page",className:"rounded border px-2 py-1 text-sm",value:String(a),onChange:e=>t(e.target.value),children:[(0,n.jsx)("option",{value:"0",children:"All"}),(0,n.jsx)("option",{value:"6",children:"6"}),(0,n.jsx)("option",{value:"12",children:"12"}),(0,n.jsx)("option",{value:"24",children:"24"})]})}function y(e){let{label:a,options:t,selected:r,onChange:l}=e,[s,o]=(0,i.useState)(!1),c=e=>{r.includes(e)?l(r.filter(a=>a!==e)):l([...r,e])};return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{type:"button","aria-haspopup":"listbox","aria-expanded":s,onClick:()=>o(e=>!e),className:"rounded border px-2 py-1 text-sm",children:r.length?"".concat(a," (").concat(r.length,")"):a}),s&&(0,n.jsx)("div",{className:"absolute z-10 mt-1 w-56 max-h-60 overflow-y-auto rounded border bg-white shadow",children:t.map(e=>(0,n.jsxs)("label",{className:"flex cursor-pointer gap-2 border-b p-2 last:border-b-0",children:[(0,n.jsx)("input",{type:"checkbox",className:"form-checkbox mt-1",checked:r.includes(e.value),onChange:()=>c(e.value)}),(0,n.jsxs)("span",{className:"text-sm",children:[e.label,e.description&&(0,n.jsx)("small",{className:"block text-xs text-gray-500",children:e.description})]})]},e.value))})]})}function S(e){let{type:a=[],city:t=[],country:i=[],pageLength:r,onChange:l,typeOptions:s=[],countryOptions:o=[],cityOptions:c=[]}=e;return(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,n.jsx)(y,{label:"Type",options:s,selected:a,onChange:e=>l("type",e)}),(0,n.jsx)(y,{label:"Country",options:o,selected:i,onChange:e=>l("country",e)}),(0,n.jsx)(y,{label:"City",options:c,selected:t,onChange:e=>l("city",e)}),(0,n.jsx)(x,{value:r,onChange:e=>l("pageLength",e)})]})}function v(){let e=(0,r.useSearchParams)(),a=(0,r.useRouter)(),t=e.get("sortBy")||"-deadline",o=parseInt(e.get("page")||"1",10),c=e.get("type")||"",d=e.get("country")||"",u=e.get("city")||"",p=e.get("search")||"",x=(0,i.useMemo)(()=>c?c.split(",").filter(Boolean):[],[c]),y=(0,i.useMemo)(()=>d?d.split(",").filter(Boolean):[],[d]),v=(0,i.useMemo)(()=>u?u.split(",").filter(Boolean):[],[u]),b=e.get("pageLength"),N=b?parseInt(b,10):6,[j,w]=(0,i.useState)([]),[C,M]=(0,i.useState)(null),[A,I]=(0,i.useState)(!0),[B,T]=(0,i.useState)(null),[G,L]=(0,i.useState)([]),[P,E]=(0,i.useState)([]),[R,k]=(0,i.useState)([]),[K,U]=(0,i.useState)(0);(0,i.useEffect)(()=>{if(!e.toString()){let e=sessionStorage.getItem("opportunity-search");e&&a.replace("/opportunities?".concat(e))}},[]);let F=e.toString();(0,i.useEffect)(()=>{sessionStorage.setItem("opportunity-search",F)},[F]),(0,i.useEffect)(()=>{let e=!1,a=sessionStorage.getItem("all-opportunities");if(a)try{let e=JSON.parse(a);w(e),U(100);return}catch(e){}return async function(){try{await (0,l.Oj)((a,t,n)=>{!e&&(w(a),sessionStorage.setItem("all-opportunities",JSON.stringify(a)),n&&U(t/n*100))},100)}catch(e){console.error(e),T(e.message)}}(),()=>{e=!0}},[]),(0,i.useEffect)(()=>{let e=(e,a)=>{let t=p.toLowerCase();return e.filter(e=>{var n,i,r,l,s;return(!(null===(n=a.type)||void 0===n?void 0:n.length)||e.type&&a.type.includes(e.type))&&(!(null===(i=a.country)||void 0===i?void 0:i.length)||(null===(r=e.profile)||void 0===r?void 0:r.country)&&a.country.includes(e.profile.country))&&(!(null===(l=a.city)||void 0===l?void 0:l.length)||(null===(s=e.profile)||void 0===s?void 0:s.city)&&a.city.includes(e.profile.city))&&(!p||e.title.toLowerCase().includes(t))})},a=e(j,{country:y,city:v}),t=e(j,{type:x,city:v}),n=e(j,{type:x,country:y}),i=Array.from(new Set(a.map(e=>e.type).filter(e=>!!e))).sort(),r=Array.from(new Set(t.map(e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.country}).filter(e=>!!e))).sort(),l=Array.from(new Set(n.map(e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.city}).filter(e=>!!e))).sort();L(i.map(e=>({value:e,label:e}))),E(r.map(e=>({value:e,label:(0,s.p)(e)||e}))),k(l.map(e=>({value:e,label:e})))},[j,x,y,v,p]),(0,i.useEffect)(()=>{I(!0),T(null);try{let e=j;if(x.length&&(e=e.filter(e=>e.type&&x.includes(e.type))),y.length&&(e=e.filter(e=>{var a;return(null===(a=e.profile)||void 0===a?void 0:a.country)&&y.includes(e.profile.country)})),v.length&&(e=e.filter(e=>{var a;return(null===(a=e.profile)||void 0===a?void 0:a.city)&&v.includes(e.profile.city)})),p){let a=p.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(a))}let a=t.startsWith("-")?t.slice(1):t,n=t.startsWith("-")?-1:1;e=e.slice().sort((e,t)=>{let i=e[a],r=t[a];if(!i||!r)return 0;let l=Date.parse(i),s=Date.parse(r);return Number.isNaN(l)||Number.isNaN(s)?String(i).localeCompare(String(r))*n:(l-s)*n});let i=N?Math.ceil(e.length/N):1,r=N?(o-1)*N:0,l=N?e.slice(r,r+N):e;M({data:l,pages:N?i:void 0,entries:e.length})}catch(e){T(e.message)}finally{I(!1)}},[j,t,o,x,y,v,N,p]);let D=e=>{a.push("/opportunities?".concat(e.toString()))},H=a=>{let t=new URLSearchParams(e.toString());t.set("sortBy",a),t.set("page","1"),D(t)},O=t=>{let n=new URLSearchParams(e.toString());n.set("id",t),a.push("/opportunities?".concat(n.toString()))};return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-4 flex flex-col gap-2",children:[(0,n.jsx)(S,{type:x,country:y,city:v,pageLength:N,onChange:(a,t)=>{let n=new URLSearchParams(e.toString());Array.isArray(t)?t.length?n.set(a,t.join(",")):n.delete(a):t?n.set(a,t):n.delete(a),n.set("page","1"),D(n)},typeOptions:G,countryOptions:P,cityOptions:R}),(0,n.jsx)("div",{className:"flex items-center justify-end",children:(0,n.jsx)(f,{value:t,onChange:H})})]}),K>0&&K<100&&(0,n.jsx)("div",{className:"progress mb-4",children:(0,n.jsxs)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(K,"%")},"aria-valuenow":K,"aria-valuemin":0,"aria-valuemax":100,children:[Math.round(K),"%"]})}),B&&(0,n.jsxs)("div",{className:"mb-4 rounded border border-red-200 bg-red-50 p-4",children:[(0,n.jsx)("p",{className:"text-red-700",children:"Failed to load opportunities."}),(0,n.jsx)("button",{className:"mt-2 rounded border px-2 py-1",onClick:()=>H(t),"aria-label":"Retry loading opportunities",children:"Retry"})]}),!A||(null==C?void 0:C.data.length)?(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:null==C?void 0:C.data.map(e=>(0,n.jsx)(g,{item:e,onClick:()=>O(e.id)},e.id))}):(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:N||6}).map((e,a)=>(0,n.jsx)(h,{},a))}),!B&&C&&0!==N&&(0,n.jsx)(m,{page:o,totalPages:C.pages,onPageChange:a=>{let t=new URLSearchParams(e.toString());t.set("page",String(a)),D(t)}})]})}},1525:function(e,a,t){t.d(a,{Oj:function(){return l},ZY:function(){return r}});let n="https://api.artconnect.com/v1";async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=new URL(n+"/opportunities/");a.searchParams.set("page",String(e));let t=await fetch(a.toString(),{headers:{Accept:"application/json"}});if(409===t.status)throw Error("409");if(!t.ok)throw Error("List fetch failed: ".concat(t.status));return await t.json()}async function r(e){async function a(){let t=await fetch("".concat(n,"/opportunities/").concat(encodeURIComponent(e),"/"),{headers:{Accept:"application/json"}});return t.ok?await t.json():(await new Promise(e=>setTimeout(e,1e3)),a())}return a()}async function l(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=1,n=[];for(;;){let r;try{r=await i(t)}catch(e){await new Promise(e=>setTimeout(e,1e3));continue}if(n.push(...r.data),e&&e(n.slice(),t,r.pages),!r.pages||t>=r.pages)break;t++,a>0&&await new Promise(e=>setTimeout(e,a))}return n}},2176:function(e,a,t){var n,i;function r(e){return e?n[e]||e:null!=e?e:void 0}t.d(a,{p:function(){return r}}),(i=n||(n={})).AF="Afghanistan",i.AX="\xc5land Islands",i.AL="Albania",i.DZ="Algeria",i.AS="American Samoa",i.AD="Andorra",i.AO="Angola",i.AI="Anguilla",i.AQ="Antarctica",i.AG="Antigua & Barbuda",i.AR="Argentina",i.AM="Armenia",i.AW="Aruba",i.AU="Australia",i.AT="Austria",i.AZ="Azerbaijan",i.BS="Bahamas",i.BH="Bahrain",i.BD="Bangladesh",i.BB="Barbados",i.BY="Belarus",i.BE="Belgium",i.BZ="Belize",i.BJ="Benin",i.BM="Bermuda",i.BT="Bhutan",i.BO="Bolivia",i.BA="Bosnia & Herzegovina",i.BW="Botswana",i.BV="Bouvet Island",i.BR="Brazil",i.IO="British Indian Ocean Territory",i.VG="British Virgin Islands",i.BN="Brunei",i.BG="Bulgaria",i.BF="Burkina Faso",i.BI="Burundi",i.KH="Cambodia",i.CM="Cameroon",i.CA="Canada",i.CV="Cape Verde",i.BQ="Caribbean Netherlands",i.KY="Cayman Islands",i.CF="Central African Republic",i.TD="Chad",i.CL="Chile",i.CN="China",i.CX="Christmas Island",i.CC="Cocos (Keeling) Islands",i.CO="Colombia",i.KM="Comoros",i.CG="Congo - Brazzaville",i.CD="Congo - Kinshasa",i.CK="Cook Islands",i.CR="Costa Rica",i.CI="C\xf4te d’Ivoire",i.HR="Croatia",i.CU="Cuba",i.CW="Cura\xe7ao",i.CY="Cyprus",i.CZ="Czechia",i.DK="Denmark",i.DJ="Djibouti",i.DM="Dominica",i.DO="Dominican Republic",i.EC="Ecuador",i.EG="Egypt",i.SV="El Salvador",i.GQ="Equatorial Guinea",i.ER="Eritrea",i.EE="Estonia",i.SZ="Eswatini",i.ET="Ethiopia",i.FK="Falkland Islands",i.FO="Faroe Islands",i.FJ="Fiji",i.FI="Finland",i.FR="France",i.GF="French Guiana",i.PF="French Polynesia",i.TF="French Southern Territories",i.GA="Gabon",i.GM="Gambia",i.GE="Georgia",i.DE="Germany",i.GH="Ghana",i.GI="Gibraltar",i.GR="Greece",i.GL="Greenland",i.GD="Grenada",i.GP="Guadeloupe",i.GU="Guam",i.GT="Guatemala",i.GG="Guernsey",i.GN="Guinea",i.GW="Guinea-Bissau",i.GY="Guyana",i.HT="Haiti",i.HM="Heard & McDonald Islands",i.HN="Honduras",i.HK="Hong Kong SAR China",i.HU="Hungary",i.IS="Iceland",i.IN="India",i.ID="Indonesia",i.IR="Iran",i.IQ="Iraq",i.IE="Ireland",i.IM="Isle of Man",i.IL="Israel",i.IT="Italy",i.JM="Jamaica",i.JP="Japan",i.JE="Jersey",i.JO="Jordan",i.KZ="Kazakhstan",i.KE="Kenya",i.KI="Kiribati",i.KW="Kuwait",i.KG="Kyrgyzstan",i.LA="Laos",i.LV="Latvia",i.LB="Lebanon",i.LS="Lesotho",i.LR="Liberia",i.LY="Libya",i.LI="Liechtenstein",i.LT="Lithuania",i.LU="Luxembourg",i.MO="Macao SAR China",i.MG="Madagascar",i.MW="Malawi",i.MY="Malaysia",i.MV="Maldives",i.ML="Mali",i.MT="Malta",i.MH="Marshall Islands",i.MQ="Martinique",i.MR="Mauritania",i.MU="Mauritius",i.YT="Mayotte",i.MX="Mexico",i.FM="Micronesia",i.MD="Moldova",i.MC="Monaco",i.MN="Mongolia",i.ME="Montenegro",i.MS="Montserrat",i.MA="Morocco",i.MZ="Mozambique",i.MM="Myanmar (Burma)",i.NA="Namibia",i.NR="Nauru",i.NP="Nepal",i.NL="Netherlands",i.NC="New Caledonia",i.NZ="New Zealand",i.NI="Nicaragua",i.NE="Niger",i.NG="Nigeria",i.NU="Niue",i.NF="Norfolk Island",i.KP="North Korea",i.MK="North Macedonia",i.MP="Northern Mariana Islands",i.NO="Norway",i.OM="Oman",i.PK="Pakistan",i.PW="Palau",i.PS="Palestinian Territories",i.PA="Panama",i.PG="Papua New Guinea",i.PY="Paraguay",i.PE="Peru",i.PH="Philippines",i.PN="Pitcairn Islands",i.PL="Poland",i.PT="Portugal",i.PR="Puerto Rico",i.QA="Qatar",i.RE="R\xe9union",i.RO="Romania",i.RU="Russia",i.RW="Rwanda",i.WS="Samoa",i.SM="San Marino",i.ST="S\xe3o Tom\xe9 & Pr\xedncipe",i.SA="Saudi Arabia",i.SN="Senegal",i.RS="Serbia",i.SC="Seychelles",i.SL="Sierra Leone",i.SG="Singapore",i.SX="Sint Maarten",i.SK="Slovakia",i.SI="Slovenia",i.SB="Solomon Islands",i.SO="Somalia",i.ZA="South Africa",i.GS="South Georgia & South Sandwich Islands",i.KR="South Korea",i.SS="South Sudan",i.ES="Spain",i.LK="Sri Lanka",i.BL="St. Barth\xe9lemy",i.SH="St. Helena",i.KN="St. Kitts & Nevis",i.LC="St. Lucia",i.MF="St. Martin",i.PM="St. Pierre & Miquelon",i.VC="St. Vincent & Grenadines",i.SD="Sudan",i.SR="Suriname",i.SJ="Svalbard & Jan Mayen",i.SE="Sweden",i.CH="Switzerland",i.SY="Syria",i.TW="Taiwan",i.TJ="Tajikistan",i.TZ="Tanzania",i.TH="Thailand",i.TL="Timor-Leste",i.TG="Togo",i.TK="Tokelau",i.TO="Tonga",i.TT="Trinidad & Tobago",i.TN="Tunisia",i.TR="Turkey",i.TM="Turkmenistan",i.TC="Turks & Caicos Islands",i.TV="Tuvalu",i.UM="U.S. Outlying Islands",i.VI="U.S. Virgin Islands",i.UG="Uganda",i.UA="Ukraine",i.AE="United Arab Emirates",i.GB="United Kingdom",i.US="United States",i.UY="Uruguay",i.UZ="Uzbekistan",i.VU="Vanuatu",i.VA="Vatican City",i.VE="Venezuela",i.VN="Vietnam",i.WF="Wallis & Futuna",i.EH="Western Sahara",i.YE="Yemen",i.ZM="Zambia",i.ZW="Zimbabwe"}}]);