(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[237],{9480:function(e,t,r){Promise.resolve().then(r.bind(r,7156))},7156:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var s=r(7437),a=r(2265),l=r(9376),n=r(5156),i=r(2972),c=r.n(i),o=r(1525);function d(e){var t,r,n,i,d;let{id:p}=e,x=(0,l.useSearchParams)(),h=(0,l.useRouter)(),[m,f]=(0,a.useState)(null),[g,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)(null);(0,a.useEffect)(()=>{j(!0),(0,o.Z)(p).then(f).catch(e=>N(e.message)).finally(()=>j(!1))},[p]);let b=new URLSearchParams(x.toString());b.delete("id");let y="/opportunities?".concat(b.toString());if(g)return(0,s.jsx)("div",{className:"py-10 text-center",role:"status",children:"Loading…"});if(v)return(0,s.jsxs)("div",{className:"py-10 text-center",children:["Failed to load. ",(0,s.jsx)("button",{className:"underline",onClick:()=>h.refresh(),children:"Retry"})]});if(!m)return null;let w=[m.profile.city,m.profile.country].filter(Boolean).join(", ");return(0,s.jsxs)("article",{className:"space-y-4",children:[(0,s.jsx)("nav",{children:(0,s.jsx)(c(),{href:y,className:"text-blue-600 hover:underline",children:"← Back to opportunities"})}),(0,s.jsxs)("header",{className:"space-y-2",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:m.title}),(0,s.jsx)("div",{className:"text-gray-600",children:m.profile.organizationName}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:w})]}),m.profile.profileImageUrl&&(0,s.jsx)("img",{src:m.profile.profileImageUrl,alt:"".concat(m.profile.organizationName," logo"),className:"h-60 w-full rounded object-cover"}),null===(t=m.description)||void 0===t?void 0:t.map((e,t)=>(0,s.jsx)("p",{className:"whitespace-pre-wrap",children:e.content},t)),(null===(r=m.required)||void 0===r?void 0:r.items)&&m.required.items.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-semibold",children:"Requirements"}),(0,s.jsx)("ul",{className:"list-disc pl-5",children:m.required.items.map(e=>(0,s.jsx)("li",{children:e},e))}),m.required.other&&(0,s.jsx)("p",{children:m.required.other})]}),m.applicationFees&&m.applicationFees.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-semibold",children:"Application Fees"}),(0,s.jsxs)("table",{className:"mt-2 w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left",children:"Price"}),(0,s.jsx)("th",{className:"text-left",children:"Currency"}),(0,s.jsx)("th",{className:"text-left",children:"Description"})]})}),(0,s.jsx)("tbody",{children:m.applicationFees.map((e,t)=>(0,s.jsxs)("tr",{className:"border-t",children:[(0,s.jsx)("td",{children:e.price}),(0,s.jsx)("td",{children:e.currency}),(0,s.jsx)("td",{children:e.description})]},t))})]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:[(null===(n=m.apply)||void 0===n?void 0:n.onlineForm)&&(0,s.jsx)("a",{href:m.apply.onlineForm,target:"_blank",rel:"noopener noreferrer",className:"inline-block rounded bg-blue-600 px-4 py-2 text-white",children:"Apply"}),(null===(i=m.contact)||void 0===i?void 0:i.url)&&(0,s.jsx)("a",{href:m.contact.url,target:"_blank",rel:"noopener noreferrer",className:"inline-block rounded border px-4 py-2",children:"Visit"}),(null===(d=m.contact)||void 0===d?void 0:d.email)&&(0,s.jsx)("a",{href:"mailto:".concat(m.contact.email),className:"inline-block rounded border px-4 py-2",children:"Email"})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,s.jsxs)("div",{children:["Created: ",u(m.createdAt)]}),(0,s.jsxs)("div",{children:["Last Modified: ",u(m.lastModifiedDate)]})]})]})}function u(e){if(!e)return"—";try{return new Date(e).toLocaleString()}catch(t){return e}}function p(){let e=(0,l.useSearchParams)().get("id");return e?(0,s.jsx)(d,{id:e}):(0,s.jsx)(n.default,{})}function x(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"py-10 text-center",role:"status",children:"Loading…"}),children:(0,s.jsx)(p,{})})}},5156:function(e,t,r){"use strict";r.d(t,{default:function(){return f}});var s=r(7437),a=r(2265),l=r(9376),n=r(1525);function i(e){let{children:t,className:r}=e;return(0,s.jsx)("span",{className:"rounded px-2 py-0.5 text-xs ".concat(r),children:t})}function c(e){let{type:t}=e;return t?(0,s.jsx)(i,{className:"bg-blue-100 text-blue-800",children:t.replace(/_/g," ")}):null}function o(e){let{text:t}=e;return(0,s.jsx)(i,{className:"bg-yellow-100 text-yellow-800",children:t})}function d(e){let{text:t}=e;return(0,s.jsx)(i,{className:"bg-green-100 text-green-800",children:t})}function u(){return(0,s.jsx)(i,{className:"bg-pink-100 text-pink-800",children:"Sponsored"})}function p(e){var t,r,a,l,n;let{item:i,onClick:p}=e,x=[i.profile.city,i.profile.country].filter(Boolean).join(", "),h=i.rewards&&i.rewards.rewardTypes&&i.rewards.rewardTypes.length>0;return(0,s.jsxs)("button",{onClick:p,className:"flex w-full flex-col overflow-hidden rounded border bg-white text-left shadow-sm hover:shadow-md focus:outline-none focus:ring","aria-label":"View details for ".concat(i.title),children:[(0,s.jsx)("div",{className:"h-40 w-full overflow-hidden bg-gray-100",children:i.profile.profileImageUrl?(0,s.jsx)("img",{src:i.profile.profileImageUrl,alt:"".concat(i.profile.organizationName," logo"),className:"h-full w-full object-cover"}):(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center text-gray-400",children:"No image"})}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-2 p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:i.title}),(null===(t=i.boost)||void 0===t?void 0:t.isHighlighted)&&(0,s.jsx)(u,{})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,s.jsx)("span",{children:i.profile.organizationName}),i.profile.verified?(0,s.jsx)("span",{className:"ml-1","aria-label":"verified",children:"✔️"}):null]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:x}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,s.jsx)(c,{type:i.type}),(0,s.jsx)(o,{text:function(e){if("FREE"===e.fee)return"Free";if(e.applicationFees&&e.applicationFees.length>0){let t=e.applicationFees[0];return"".concat(t.price," ").concat(t.currency)}return e.fee?e.fee:"No fee"}(i)}),h?i.rewards.rewardTypes.map(e=>(0,s.jsx)(d,{text:e},e)):(null===(r=i.rewards)||void 0===r?void 0:r.rewardDescription)&&(0,s.jsx)(d,{text:i.rewards.rewardDescription.slice(0,20)})]}),(0,s.jsx)("div",{className:"text-sm text-gray-700",children:(n=null===(l=i.description)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.content)?n.replace(/\n+/g," ").slice(0,200)+(n.length>200?"…":""):""}),(0,s.jsxs)("div",{className:"mt-auto text-sm font-medium",children:["Deadline: ",function(e){if(!e)return"No deadline";try{return new Date(e).toLocaleDateString()}catch(t){return e}}(i.deadline)]})]})]})}function x(){return(0,s.jsxs)("div",{className:"flex w-full flex-col overflow-hidden rounded border bg-white p-4 shadow-sm animate-pulse",children:[(0,s.jsx)("div",{className:"mb-4 h-40 w-full bg-gray-200"}),(0,s.jsx)("div",{className:"mb-2 h-4 w-3/4 bg-gray-200"}),(0,s.jsx)("div",{className:"mb-2 h-3 w-1/2 bg-gray-200"}),(0,s.jsx)("div",{className:"h-3 w-full bg-gray-200"})]})}function h(e){let{page:t,totalPages:r,onPageChange:a}=e;if(!r||r<=1)return null;let l=Array.from({length:r},(e,t)=>t+1);return(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2","aria-label":"Pagination navigation",children:[(0,s.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>a(t-1),disabled:t<=1,"aria-label":"Previous page",children:"Prev"}),l.map(e=>(0,s.jsx)("button",{className:"rounded border px-2 py-1 text-sm ".concat(e===t?"bg-gray-200":""),onClick:()=>a(e),"aria-current":e===t?"page":void 0,children:e},e)),(0,s.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>a(t+1),disabled:t>=r,"aria-label":"Next page",children:"Next"})]})}function m(e){let{value:t,onChange:r}=e;return(0,s.jsxs)("select",{"aria-label":"Sort opportunities",className:"rounded border px-2 py-1 text-sm",value:t,onChange:e=>r(e.target.value),children:[(0,s.jsx)("option",{value:"-deadline",children:"Deadline (latest)"}),(0,s.jsx)("option",{value:"deadline",children:"Deadline (earliest)"}),(0,s.jsx)("option",{value:"-createdAt",children:"Newest"})]})}function f(){let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),r=e.get("sortBy")||"-deadline",i=parseInt(e.get("page")||"1",10),[c,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[f,g]=(0,a.useState)(null);(0,a.useEffect)(()=>{u(!0),g(null),(0,n.N)({sortBy:r,page:i}).then(e=>o(e)).catch(e=>g(e.message)).finally(()=>u(!1))},[r,i]);let j=e=>{t.push("/opportunities?".concat(e.toString()))},v=t=>{let r=new URLSearchParams(e.toString());r.set("sortBy",t),r.set("page","1"),j(r)},N=r=>{let s=new URLSearchParams(e.toString());s.set("id",r),t.push("/opportunities?".concat(s.toString()))};return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-4 flex items-center justify-end",children:(0,s.jsx)(m,{value:r,onChange:v})}),f&&(0,s.jsxs)("div",{className:"mb-4 rounded border border-red-200 bg-red-50 p-4",children:[(0,s.jsx)("p",{className:"text-red-700",children:"Failed to load opportunities."}),(0,s.jsx)("button",{className:"mt-2 rounded border px-2 py-1",onClick:()=>v(r),"aria-label":"Retry loading opportunities",children:"Retry"})]}),d?(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,s.jsx)(x,{},t))}):(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:null==c?void 0:c.data.map(e=>(0,s.jsx)(p,{item:e,onClick:()=>N(e.id)},e.id))}),!d&&!f&&(0,s.jsx)(h,{page:i,totalPages:null==c?void 0:c.pages,onPageChange:t=>{let r=new URLSearchParams(e.toString());r.set("page",String(t)),j(r)}})]})}},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},1525:function(e,t,r){"use strict";r.d(t,{N:function(){return a},Z:function(){return l}});let s="https://api.artconnect.com/v1";async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URL(s+"/opportunities/");e.sortBy&&t.searchParams.set("sortBy",e.sortBy),e.page&&t.searchParams.set("page",String(e.page));let r=await fetch(t.toString(),{headers:{Accept:"application/json"}});if(!r.ok)throw Error("List fetch failed: ".concat(r.status));return await r.json()}async function l(e){let t=await fetch("".concat(s,"/opportunities/").concat(encodeURIComponent(e),"/"),{headers:{Accept:"application/json"}});if(!t.ok)throw Error("Detail fetch failed: ".concat(t.status));return await t.json()}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=9480)}),_N_E=e.O()}]);