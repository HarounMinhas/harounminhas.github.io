(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8633:function(e,t,a){Promise.resolve().then(a.bind(a,8999))},8999:function(e,t,a){"use strict";a.d(t,{default:function(){return j}});var r=a(7437),n=a(2265),s=a(9376),l=a(1525);function i(e){let{children:t,className:a}=e;return(0,r.jsx)("span",{className:"rounded px-2 py-0.5 text-xs ".concat(a),children:t})}function o(e){let{type:t}=e;return t?(0,r.jsx)(i,{className:"bg-blue-100 text-blue-800",children:t.replace(/_/g," ")}):null}function c(e){let{text:t}=e;return(0,r.jsx)(i,{className:"bg-yellow-100 text-yellow-800",children:t})}function d(e){let{text:t}=e;return(0,r.jsx)(i,{className:"bg-green-100 text-green-800",children:t})}function u(){return(0,r.jsx)(i,{className:"bg-pink-100 text-pink-800",children:"Sponsored"})}function p(e){var t,a,n,s,l;let{item:i,onClick:p}=e,g=[i.profile.city,i.profile.country].filter(Boolean).join(", "),h=i.rewards&&i.rewards.rewardTypes&&i.rewards.rewardTypes.length>0;return(0,r.jsxs)("button",{onClick:p,className:"flex w-full flex-col overflow-hidden rounded border bg-white text-left shadow-sm hover:shadow-md focus:outline-none focus:ring","aria-label":"View details for ".concat(i.title),children:[(0,r.jsx)("div",{className:"h-40 w-full overflow-hidden bg-gray-100",children:i.profile.profileImageUrl?(0,r.jsx)("img",{src:i.profile.profileImageUrl,alt:"".concat(i.profile.organizationName," logo"),className:"h-full w-full object-cover"}):(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center text-gray-400",children:"No image"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:i.title}),(null===(t=i.boost)||void 0===t?void 0:t.isHighlighted)&&(0,r.jsx)(u,{})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsx)("span",{children:i.profile.organizationName}),i.profile.verified?(0,r.jsx)("span",{className:"ml-1","aria-label":"verified",children:"✔️"}):null]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:g}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,r.jsx)(o,{type:i.type}),(0,r.jsx)(c,{text:function(e){if("FREE"===e.fee)return"Free";if(e.applicationFees&&e.applicationFees.length>0){let t=e.applicationFees[0];return"".concat(t.price," ").concat(t.currency)}return e.fee?e.fee:"No fee"}(i)}),h?i.rewards.rewardTypes.map(e=>(0,r.jsx)(d,{text:e},e)):(null===(a=i.rewards)||void 0===a?void 0:a.rewardDescription)&&(0,r.jsx)(d,{text:i.rewards.rewardDescription.slice(0,20)})]}),(0,r.jsx)("div",{className:"text-sm text-gray-700",children:(l=null===(s=i.description)||void 0===s?void 0:null===(n=s[0])||void 0===n?void 0:n.content)?l.replace(/\n+/g," ").slice(0,200)+(l.length>200?"…":""):""}),(0,r.jsxs)("div",{className:"mt-auto text-sm font-medium",children:["Deadline: ",function(e){if(!e)return"No deadline";try{return new Date(e).toLocaleDateString()}catch(t){return e}}(i.deadline)]})]})]})}function g(){return(0,r.jsxs)("div",{className:"flex w-full flex-col overflow-hidden rounded border bg-white p-4 shadow-sm animate-pulse",children:[(0,r.jsx)("div",{className:"mb-4 h-40 w-full bg-gray-200"}),(0,r.jsx)("div",{className:"mb-2 h-4 w-3/4 bg-gray-200"}),(0,r.jsx)("div",{className:"mb-2 h-3 w-1/2 bg-gray-200"}),(0,r.jsx)("div",{className:"h-3 w-full bg-gray-200"})]})}function h(e){let{page:t,totalPages:a,onPageChange:n}=e;if(!a||a<=1)return null;let s=Array.from({length:a},(e,t)=>t+1);return(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2","aria-label":"Pagination navigation",children:[(0,r.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>n(t-1),disabled:t<=1,"aria-label":"Previous page",children:"Prev"}),s.map(e=>(0,r.jsx)("button",{className:"rounded border px-2 py-1 text-sm ".concat(e===t?"bg-gray-200":""),onClick:()=>n(e),"aria-current":e===t?"page":void 0,children:e},e)),(0,r.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>n(t+1),disabled:t>=a,"aria-label":"Next page",children:"Next"})]})}function x(e){let{value:t,onChange:a}=e;return(0,r.jsxs)("select",{"aria-label":"Sort opportunities",className:"rounded border px-2 py-1 text-sm",value:t,onChange:e=>a(e.target.value),children:[(0,r.jsx)("option",{value:"-deadline",children:"Deadline (latest)"}),(0,r.jsx)("option",{value:"deadline",children:"Deadline (earliest)"}),(0,r.jsx)("option",{value:"-createdAt",children:"Newest"})]})}function f(e){let{ariaLabel:t,placeholder:a,value:n,onChange:s}=e;return(0,r.jsx)("input",{"aria-label":t,placeholder:a,className:"rounded border px-2 py-1 text-sm",value:n,onChange:e=>s(e.target.value)})}function m(e){let{value:t,onChange:a}=e;return(0,r.jsxs)("select",{"aria-label":"Items per page",className:"rounded border px-2 py-1 text-sm",value:String(t),onChange:e=>a(e.target.value),children:[(0,r.jsx)("option",{value:"0",children:"All"}),(0,r.jsx)("option",{value:"6",children:"6"}),(0,r.jsx)("option",{value:"12",children:"12"}),(0,r.jsx)("option",{value:"24",children:"24"})]})}function y(e){let{type:t="",city:a="",country:n="",pageLength:s,onChange:l}=e;return(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)(f,{ariaLabel:"Filter by type",placeholder:"Type",value:t,onChange:e=>l("type",e)}),(0,r.jsx)(f,{ariaLabel:"Filter by country",placeholder:"Country",value:n,onChange:e=>l("country",e)}),(0,r.jsx)(f,{ariaLabel:"Filter by city",placeholder:"City",value:a,onChange:e=>l("city",e)}),(0,r.jsx)(m,{value:s,onChange:e=>l("pageLength",e)})]})}function j(){let e=(0,s.useSearchParams)(),t=(0,s.useRouter)(),a=e.get("sortBy")||"-deadline",i=parseInt(e.get("page")||"1",10),o=e.get("type")||"",c=e.get("country")||"",d=e.get("city")||"",u=e.get("pageLength"),f=u?parseInt(u,10):6,[m,j]=(0,n.useState)(null),[v,b]=(0,n.useState)(!0),[N,w]=(0,n.useState)(null);(0,n.useEffect)(()=>{b(!0),w(null),(0,l.N)({sortBy:a,page:i,type:o,country:c,city:d,pageLength:f}).then(e=>j(e)).catch(e=>w(e.message)).finally(()=>b(!1))},[a,i,o,c,d,f]);let S=e=>{t.push("/opportunities?".concat(e.toString()))},C=t=>{let a=new URLSearchParams(e.toString());a.set("sortBy",t),a.set("page","1"),S(a)},P=a=>{let r=new URLSearchParams(e.toString());r.set("id",a),t.push("/opportunities?".concat(r.toString()))};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-4 flex flex-col gap-2",children:[(0,r.jsx)(y,{type:o,country:c,city:d,pageLength:f,onChange:(t,a)=>{let r=new URLSearchParams(e.toString());a?r.set(t,a):r.delete(t),r.set("page","1"),S(r)}}),(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsx)(x,{value:a,onChange:C})})]}),N&&(0,r.jsxs)("div",{className:"mb-4 rounded border border-red-200 bg-red-50 p-4",children:[(0,r.jsx)("p",{className:"text-red-700",children:"Failed to load opportunities."}),(0,r.jsx)("button",{className:"mt-2 rounded border px-2 py-1",onClick:()=>C(a),"aria-label":"Retry loading opportunities",children:"Retry"})]}),v?(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:f||6}).map((e,t)=>(0,r.jsx)(g,{},t))}):(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:null==m?void 0:m.data.map(e=>(0,r.jsx)(p,{item:e,onClick:()=>P(e.id)},e.id))}),!v&&!N&&0!==f&&(0,r.jsx)(h,{page:i,totalPages:null==m?void 0:m.pages,onPageChange:t=>{let a=new URLSearchParams(e.toString());a.set("page",String(t)),S(a)}})]})}},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},1525:function(e,t,a){"use strict";a.d(t,{N:function(){return n},Z:function(){return s}});let r="https://api.artconnect.com/v1";async function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URL(r+"/opportunities/");e.sortBy&&t.searchParams.set("sortBy",e.sortBy),e.page&&t.searchParams.set("page",String(e.page)),e.type&&t.searchParams.set("type",e.type),e.country&&t.searchParams.set("country",e.country),e.city&&t.searchParams.set("city",e.city),void 0!==e.pageLength&&t.searchParams.set("pageLength",String(e.pageLength));let a=await fetch(t.toString(),{headers:{Accept:"application/json"}});if(!a.ok)throw Error("List fetch failed: ".concat(a.status));return await a.json()}async function s(e){let t=await fetch("".concat(r,"/opportunities/").concat(encodeURIComponent(e),"/"),{headers:{Accept:"application/json"}});if(!t.ok)throw Error("Detail fetch failed: ".concat(t.status));return await t.json()}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=8633)}),_N_E=e.O()}]);