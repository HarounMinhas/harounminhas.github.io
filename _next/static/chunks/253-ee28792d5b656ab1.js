"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{5253:function(e,t,a){a.d(t,{default:function(){return j}});var r=a(7437),s=a(2265),l=a(9376),n=a(1525);function i(e){let{children:t,className:a}=e;return(0,r.jsx)("span",{className:"rounded px-2 py-0.5 text-xs ".concat(a),children:t})}function o(e){let{type:t}=e;return t?(0,r.jsx)(i,{className:"bg-blue-100 text-blue-800",children:t.replace(/_/g," ")}):null}function c(e){let{text:t}=e;return(0,r.jsx)(i,{className:"bg-yellow-100 text-yellow-800",children:t})}function d(e){let{text:t}=e;return(0,r.jsx)(i,{className:"bg-green-100 text-green-800",children:t})}function u(){return(0,r.jsx)(i,{className:"bg-pink-100 text-pink-800",children:"Sponsored"})}function p(e){var t,a,s,l,n;let{item:i,onClick:p}=e,h=[i.profile.city,i.profile.country].filter(Boolean).join(", "),g=i.rewards&&i.rewards.rewardTypes&&i.rewards.rewardTypes.length>0;return(0,r.jsxs)("button",{onClick:p,className:"flex w-full flex-col overflow-hidden rounded border bg-white text-left shadow-sm hover:shadow-md focus:outline-none focus:ring","aria-label":"View details for ".concat(i.title),children:[(0,r.jsx)("div",{className:"h-40 w-full overflow-hidden bg-gray-100",children:i.profile.profileImageUrl?(0,r.jsx)("img",{src:i.profile.profileImageUrl,alt:"".concat(i.profile.organizationName," logo"),className:"h-full w-full object-cover"}):(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center text-gray-400",children:"No image"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:i.title}),(null===(t=i.boost)||void 0===t?void 0:t.isHighlighted)&&(0,r.jsx)(u,{})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsx)("span",{children:i.profile.organizationName}),i.profile.verified?(0,r.jsx)("span",{className:"ml-1","aria-label":"verified",children:"✔️"}):null]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:h}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,r.jsx)(o,{type:i.type}),(0,r.jsx)(c,{text:function(e){if("FREE"===e.fee)return"Free";if(e.applicationFees&&e.applicationFees.length>0){let t=e.applicationFees[0];return"".concat(t.price," ").concat(t.currency)}return e.fee?e.fee:"No fee"}(i)}),g?i.rewards.rewardTypes.map(e=>(0,r.jsx)(d,{text:e},e)):(null===(a=i.rewards)||void 0===a?void 0:a.rewardDescription)&&(0,r.jsx)(d,{text:i.rewards.rewardDescription.slice(0,20)})]}),(0,r.jsx)("div",{className:"text-sm text-gray-700",children:(n=null===(l=i.description)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.content)?n.replace(/\n+/g," ").slice(0,200)+(n.length>200?"…":""):""}),(0,r.jsxs)("div",{className:"mt-auto text-sm font-medium",children:["Deadline: ",function(e){if(!e)return"No deadline";try{return new Date(e).toLocaleDateString()}catch(t){return e}}(i.deadline)]})]})]})}function h(){return(0,r.jsxs)("div",{className:"flex w-full flex-col overflow-hidden rounded border bg-white p-4 shadow-sm animate-pulse",children:[(0,r.jsx)("div",{className:"mb-4 h-40 w-full bg-gray-200"}),(0,r.jsx)("div",{className:"mb-2 h-4 w-3/4 bg-gray-200"}),(0,r.jsx)("div",{className:"mb-2 h-3 w-1/2 bg-gray-200"}),(0,r.jsx)("div",{className:"h-3 w-full bg-gray-200"})]})}function g(e){let{page:t,totalPages:a,onPageChange:s}=e;if(!a||a<=1)return null;let l=Array.from({length:a},(e,t)=>t+1);return(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2","aria-label":"Pagination navigation",children:[(0,r.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>s(t-1),disabled:t<=1,"aria-label":"Previous page",children:"Prev"}),l.map(e=>(0,r.jsx)("button",{className:"rounded border px-2 py-1 text-sm ".concat(e===t?"bg-gray-200":""),onClick:()=>s(e),"aria-current":e===t?"page":void 0,children:e},e)),(0,r.jsx)("button",{className:"rounded border px-2 py-1 text-sm disabled:opacity-50",onClick:()=>s(t+1),disabled:t>=a,"aria-label":"Next page",children:"Next"})]})}function x(e){let{value:t,onChange:a}=e;return(0,r.jsxs)("select",{"aria-label":"Sort opportunities",className:"rounded border px-2 py-1 text-sm",value:t,onChange:e=>a(e.target.value),children:[(0,r.jsx)("option",{value:"-deadline",children:"Deadline (latest)"}),(0,r.jsx)("option",{value:"deadline",children:"Deadline (earliest)"}),(0,r.jsx)("option",{value:"-createdAt",children:"Newest"})]})}function m(e){let{value:t,onChange:a}=e;return(0,r.jsxs)("select",{"aria-label":"Items per page",className:"rounded border px-2 py-1 text-sm",value:String(t),onChange:e=>a(e.target.value),children:[(0,r.jsx)("option",{value:"0",children:"All"}),(0,r.jsx)("option",{value:"6",children:"6"}),(0,r.jsx)("option",{value:"12",children:"12"}),(0,r.jsx)("option",{value:"24",children:"24"})]})}function f(e){let{label:t,options:a,selected:l,onChange:n}=e,[i,o]=(0,s.useState)(!1),c=e=>{l.includes(e)?n(l.filter(t=>t!==e)):n([...l,e])};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{type:"button","aria-haspopup":"listbox","aria-expanded":i,onClick:()=>o(e=>!e),className:"rounded border px-2 py-1 text-sm",children:l.length?"".concat(t," (").concat(l.length,")"):t}),i&&(0,r.jsx)("div",{className:"absolute z-10 mt-1 w-56 max-h-60 overflow-y-auto rounded border bg-white shadow",children:a.map(e=>(0,r.jsxs)("label",{className:"flex cursor-pointer gap-2 border-b p-2 last:border-b-0",children:[(0,r.jsx)("input",{type:"checkbox",className:"form-checkbox mt-1",checked:l.includes(e.value),onChange:()=>c(e.value)}),(0,r.jsxs)("span",{className:"text-sm",children:[e.label,e.description&&(0,r.jsx)("small",{className:"block text-xs text-gray-500",children:e.description})]})]},e.value))})]})}function y(e){let{type:t=[],city:a=[],country:s=[],pageLength:l,onChange:n,typeOptions:i=[],countryOptions:o=[],cityOptions:c=[]}=e;return(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)(f,{label:"Type",options:i,selected:t,onChange:e=>n("type",e)}),(0,r.jsx)(f,{label:"Country",options:o,selected:s,onChange:e=>n("country",e)}),(0,r.jsx)(f,{label:"City",options:c,selected:a,onChange:e=>n("city",e)}),(0,r.jsx)(m,{value:l,onChange:e=>n("pageLength",e)})]})}function j(){let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),a=e.get("sortBy")||"-deadline",i=parseInt(e.get("page")||"1",10),o=e.get("type")||"",c=e.get("country")||"",d=e.get("city")||"",u=e.get("search")||"",m=(0,s.useMemo)(()=>o?o.split(",").filter(Boolean):[],[o]),f=(0,s.useMemo)(()=>c?c.split(",").filter(Boolean):[],[c]),j=(0,s.useMemo)(()=>d?d.split(",").filter(Boolean):[],[d]),v=e.get("pageLength"),b=v?parseInt(v,10):6,[w,N]=(0,s.useState)(null),[S,C]=(0,s.useState)(!0),[k,A]=(0,s.useState)(null),[P,L]=(0,s.useState)([]),[R,B]=(0,s.useState)([]),[D,E]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=!1;return async function(){try{let t=await (0,n.Oj)();if(e)return;let a=Array.from(new Set(t.map(e=>e.type).filter(e=>!!e))).sort(),r=Array.from(new Set(t.map(e=>{var t;return null===(t=e.profile)||void 0===t?void 0:t.country}).filter(e=>!!e))).sort(),s=Array.from(new Set(t.map(e=>{var t;return null===(t=e.profile)||void 0===t?void 0:t.city}).filter(e=>!!e))).sort();L(a.map(e=>({value:e,label:e}))),B(r.map(e=>({value:e,label:e}))),E(s.map(e=>({value:e,label:e})))}catch(e){console.error(e)}}(),()=>{e=!0}},[]),(0,s.useEffect)(()=>{C(!0),A(null),(0,n.N9)({sortBy:a,page:i,type:m,country:f,city:j,pageLength:b,search:u}).then(e=>N(e)).catch(e=>A(e.message)).finally(()=>C(!1))},[a,i,m,f,j,b,u]);let U=e=>{t.push("/opportunities?".concat(e.toString()))},F=t=>{let a=new URLSearchParams(e.toString());a.set("sortBy",t),a.set("page","1"),U(a)},I=a=>{let r=new URLSearchParams(e.toString());r.set("id",a),t.push("/opportunities?".concat(r.toString()))};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-4 flex flex-col gap-2",children:[(0,r.jsx)(y,{type:m,country:f,city:j,pageLength:b,onChange:(t,a)=>{let r=new URLSearchParams(e.toString());Array.isArray(a)?a.length?r.set(t,a.join(",")):r.delete(t):a?r.set(t,a):r.delete(t),r.set("page","1"),U(r)},typeOptions:P,countryOptions:R,cityOptions:D}),(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsx)(x,{value:a,onChange:F})})]}),k&&(0,r.jsxs)("div",{className:"mb-4 rounded border border-red-200 bg-red-50 p-4",children:[(0,r.jsx)("p",{className:"text-red-700",children:"Failed to load opportunities."}),(0,r.jsx)("button",{className:"mt-2 rounded border px-2 py-1",onClick:()=>F(a),"aria-label":"Retry loading opportunities",children:"Retry"})]}),S?(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:b||6}).map((e,t)=>(0,r.jsx)(h,{},t))}):(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:null==w?void 0:w.data.map(e=>(0,r.jsx)(p,{item:e,onClick:()=>I(e.id)},e.id))}),!S&&!k&&0!==b&&(0,r.jsx)(g,{page:i,totalPages:null==w?void 0:w.pages,onPageChange:t=>{let a=new URLSearchParams(e.toString());a.set("page",String(t)),U(a)}})]})}},1525:function(e,t,a){a.d(t,{N9:function(){return s},Oj:function(){return n},ZY:function(){return l}});let r="https://api.artconnect.com/v1";async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URL(r+"/opportunities/");if(e.sortBy&&t.searchParams.set("sortBy",e.sortBy),e.page&&t.searchParams.set("page",String(e.page)),e.type){let a=Array.isArray(e.type)?e.type.join(","):e.type;t.searchParams.set("type",a)}if(e.country){let a=Array.isArray(e.country)?e.country.join(","):e.country;t.searchParams.set("country",a)}if(e.city){let a=Array.isArray(e.city)?e.city.join(","):e.city;t.searchParams.set("city",a)}void 0!==e.pageLength&&t.searchParams.set("pageLength",String(e.pageLength)),e.search&&t.searchParams.set("search",e.search);let a=await fetch(t.toString(),{headers:{Accept:"application/json"}});if(!a.ok)throw Error("List fetch failed: ".concat(a.status));return await a.json()}async function l(e){let t=await fetch("".concat(r,"/opportunities/").concat(encodeURIComponent(e),"/"),{headers:{Accept:"application/json"}});if(!t.ok)throw Error("Detail fetch failed: ".concat(t.status));return await t.json()}async function n(){let e=1,t=[];for(;;){let a=await s({page:e,pageLength:100});if(t.push(...a.data),!a.pages||e>=a.pages)break;e++}return t}}}]);